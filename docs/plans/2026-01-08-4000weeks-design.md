# 4000 Weeks App - Design Document

**Date:** January 8, 2026
**Phase:** 1 - Core Workflow Prototype
**Status:** Approved for Implementation

## Overview

4000 Weeks is a strategic focus management application that enforces intentional alignment between daily activities and long-term goals. The core philosophy centers on constraint as feature: limiting users to 3 active projects (plus permanent Life Ops) forces meaningful prioritization of finite time.

## Design Decisions

### Technology Stack

**Frontend Framework:** Vite + React + TypeScript
- Fast development server and build times
- Modern tooling without Next.js complexity
- Perfect for SPA architecture

**UI Components:** shadcn/ui + Tailwind CSS
- Copy-paste component ownership (not npm dependency)
- Built-in accessibility via Radix UI
- Customizable with Tailwind

**State Management:** TanStack Query (React Query)
- Automatic caching and background sync
- Built-in loading/error states
- Perfect for Supabase integration
- Optimistic updates for snappy UX

**Backend:** Supabase (from day one)
- PostgreSQL database
- Built-in authentication
- Real-time subscriptions ready for Phase 2
- Hosted backend (no server management)

**Deployment:** Vercel (planned)
- Seamless Vite deployment
- Edge network for global performance

### Architecture Pattern

**Feature-first folder structure** over layer-first organization:

```
src/
├── features/
│   ├── auth/           # Authentication, protected routes
│   ├── weeks/          # Weeks counter calculation & display
│   ├── projects/       # Project CRUD, 3+1 constraint enforcement
│   ├── tasks/          # Task management, project assignment
│   └── calendar/       # Weekly view, time blocking
├── lib/                # Shared utilities
│   ├── supabase.ts     # Supabase client configuration
│   ├── types.ts        # Shared TypeScript interfaces
│   └── hooks.ts        # Generic custom hooks
├── components/         # Reusable UI components
│   └── ui/             # shadcn/ui components
└── App.tsx             # Routing and layout
```

**Rationale:** As features expand in Phase 2, keeping related code together prevents sprawl. Natural code-splitting boundaries. Mirrors user's mental model of the application.

### Data Model (Phase 1)

**Core Entities:**

1. **users**
   - id, email, birth_date, created_at, settings

2. **projects**
   - id, user_id, title, description, status (active/parked/completed)
   - is_life_ops (boolean), position (1-4), goal_id (nullable for Phase 1)

3. **tasks**
   - id, project_id (required), title, estimated_minutes
   - status (pending/completed), scheduled_date

4. **annual_goals** (simplified for Phase 1)
   - id, user_id, title, description, year

**Key Constraints:**
- Maximum 3 active projects (excluding Life Ops which is always active)
- Tasks cannot exist without project assignment
- Enforced at UI and database level (trigger planned for Phase 2)

### User Interface Design

#### Design Philosophy

**No-Guilt Design Principles:**
- Avoid red for incomplete tasks (too punitive)
- No streak counters or guilt-inducing badges
- Calm, muted color palette with subtle accents
- Weeks counter present but not alarming
- Frame language as choices, not obligations

**Constraint as Empowerment:**
- 3-project limit feels liberating, not restrictive
- Empty project slots are invitations, not failures
- Swap mechanisms make trade-offs explicit and easy

#### Screen Architecture

**1. Weekly Planning View (Primary Workspace)**

Three-panel desktop layout (1200px+):

- **Left Panel (300px):** Active Projects
  - Life Ops (always visible, badged)
  - 3 active project slots
  - Task lists per project with quick-add
  - Collapsible Parking Lot at bottom

- **Center Panel (flexible):** Week Calendar
  - 7-day column view with navigation
  - Scheduled time blocks
  - Drag-and-drop task scheduling
  - Visual hours committed vs. available

- **Right Panel (320px):** Today's Focus
  - Hours committed by project
  - Chronological time block list
  - Task checkboxes for quick completion

**2. Goals & Projects View**

Single-column strategic overview:

- Vision statement (collapsible, markdown)
- Annual goals grid (2-3 per row)
- Active projects: visual 4-slot representation of 3+1 constraint
- Parking Lot (collapsible list)
- Drag to reorder active projects

**3. Daily Focus View**

Minimal execution interface:

- Current task + project context
- Optional timer
- Next 2-3 scheduled blocks
- Simple actions: Complete / Skip / Defer
- Focus Mode toggle (hides all navigation)

**4. Reflection View (Basic)**

Weekly review for building wisdom:

- Week summary with hours by project
- Reflection prompts (freeform text)
- Historical view of past reflections

#### Component Library

**Key Compound Components:**

1. **ProjectCard** - Active/parked project display with task list
2. **TaskList** - Checkbox list with time estimates and project badges
3. **WeekCalendar** - 7-day grid with drag-and-drop zones
4. **TimeBlock** - Scheduled task with time/project/actions
5. **WeeksCounter** - Persistent header: "Week X of ~4,000"
6. **ProjectSlotManager** - Visual UI for 3+1 constraint with swap mechanism

### State Management Strategy

**React Query for Server State:**
- `useProjects()` - Fetches active/parked projects, enforces constraints
- `useTasks(projectId)` - Project-specific task lists
- `useWeeksCounter()` - Calculates from user.birth_date
- `useWeekCalendar(weekStart)` - Weekly task schedule

**Mutations with Validation:**
- `useCreateProject()` - Validates max 3 active before Supabase call
- `useUpdateProjectStatus()` - Handles activate/park swaps
- `useCreateTask()` - Requires project_id selection

**Local Component State:**
- Drag states, expanded panels, modal visibility
- Stays in component useState/useReducer

### User Flows

**First-Time User Onboarding:**

1. Login/Signup (Supabase Auth)
2. Birth date input modal (for weeks calculation)
3. Brief 3-step welcome tour explaining 3+1 philosophy
4. Empty state with helpful prompts

**Core Daily Flow:**

1. Land on Weekly Planning View
2. Review active projects and this week's schedule
3. Drag tasks to time slots for today/week
4. Switch to Daily Focus view for execution
5. Check off completed tasks
6. (Optional) Add new tasks to project lists

**Project Management Flow:**

1. Go to Goals & Projects view
2. Create/edit annual goals
3. Create new project linked to goal
4. If 3 projects already active, choose one to park
5. New project becomes active in chosen slot
6. Return to Weekly Planning to schedule tasks

## What's Included in Phase 1

- ✅ Full Supabase backend with authentication
- ✅ User profile with birth date
- ✅ Weeks counter calculation and display
- ✅ Project management with 3+1 constraint enforcement
- ✅ Parking lot functionality with swap mechanism
- ✅ Task CRUD with required project assignment
- ✅ Basic time blocking (no calendar sync)
- ✅ Weekly Planning View (3-panel layout)
- ✅ Goals & Projects management screen
- ✅ Daily Focus execution view
- ✅ Basic Reflection view
- ✅ Desktop-first responsive design (usable on tablet)

## Deferred to Phase 2

- ⏸️ Google Calendar bidirectional sync
- ⏸️ Recurring tasks with habit tracking
- ⏸️ Guided weekly planning ritual flow
- ⏸️ Advanced analytics and project health dashboard
- ⏸️ Full Pomodoro timer integration
- ⏸️ Mobile-optimized responsive polish
- ⏸️ Real-time collaboration features
- ⏸️ Database triggers for constraint enforcement
- ⏸️ Historical data visualization
- ⏸️ Export/import functionality

## Success Criteria for Phase 1

The prototype is successful if a user can:

1. Create an account and see their weeks counter
2. Create up to 3 active projects plus Life Ops
3. Experience the constraint when trying to activate a 4th project
4. Add tasks that must belong to a project
5. View their week in a calendar layout
6. Schedule tasks to specific days
7. See today's focus in the right panel
8. Park/activate projects with a clear swap mechanism
9. Complete the basic weekly reflection

## Next Steps

1. ✅ Design approved and documented
2. → Set up Vite + React + TypeScript project
3. → Install and configure dependencies (Tailwind, shadcn/ui, React Query, Supabase)
4. → Create Supabase schema with SQL migrations
5. → Build authentication flow
6. → Implement core features (weeks counter → projects → tasks → calendar)
7. → Polish and user testing

---

*This design was validated through collaborative brainstorming on January 8, 2026.*
